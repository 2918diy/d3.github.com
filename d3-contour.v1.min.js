// https://d3js.org/d3-contour/ Version 1.0.0. Copyright 2017 Mike Bostock.
!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("d3-array")):"function"==typeof define&&define.amd?define(["exports","d3-array"],n):n(r.d3=r.d3||{},r.d3)}(this,function(r,n){"use strict";function t(r,n){for(var t=n[0],o=n[1],i=-1,u=0,f=r.length,a=f-1;u<f;a=u++){var c=r[u],s=c[0],d=c[1],h=r[a],l=h[0],g=h[1];if(e(c,h,n))return 0;d>o!=g>o&&t<(l-s)*(o-d)/(g-d)+s&&(i=-i)}return i}function e(r,n,t){var e;return o(r,n,t)&&i(r[e=+(r[0]===n[0])],t[e],n[e])}function o(r,n,t){return(n[0]-r[0])*(t[1]-r[1])==(t[0]-r[0])*(n[1]-r[1])}function i(r,n,t){return r<=n&&n<=t||t<=n&&n<=r}var u=Array.prototype,f=u.slice,a=function(r,n){return r-n},c=function(r){for(var n=0,t=r.length,e=r[t-1][1]*r[0][0]-r[t-1][0]*r[0][1];++n<t;)e+=r[n-1][1]*r[n][0]-r[n-1][0]*r[n][1];return e},s=function(r){return function(){return r}},d=function(r,n){for(var e,o=-1,i=n.length;++o<i;)if(e=t(r,n[o]))return e;return 0},h=function(){},l=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,.5],[.5,1]],[[1,1.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,1.5]],[[1.5,1],[1,.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]],g=function(){function r(r){var e=g(r);if(Array.isArray(e))e=e.slice().sort(a);else{var o=n.extent(r),i=o[0],u=o[1];e=n.tickStep(i,u,e),e=n.range(Math.floor(i/e)*e,Math.floor(u/e)*e,e)}return e.map(function(n){var e=[],o=[];return t(r,n,function(t){p(t,r,n),c(t)>0?e.push([t]):o.push(t)}),o.forEach(function(r){for(var n,t=0,o=e.length;t<o;++t)if(d((n=e[t])[0],r))return void n.push(r)}),e}).map(function(r,n){return{type:"MultiPolygon",value:e[n],coordinates:r}})}function t(r,n,t){function o(r){var n,o,i=[r[0][0]+f,r[0][1]+a],u=[r[1][0]+f,r[1][1]+a],c=e(i),s=e(u);(n=p[c])?(o=g[s])?(delete p[n.end],delete g[o.start],n===o?(n.ring.push(u),t(n.ring)):g[n.start]=p[o.end]={start:n.start,end:o.end,ring:n.ring.concat(o.ring)}):(delete p[n.end],n.ring.push(u),p[n.end=s]=n):(n=g[s])?(o=p[c])?(delete g[n.start],delete p[o.end],n===o?(n.ring.push(u),t(n.ring)):g[o.start]=p[n.end]={start:o.start,end:n.end,ring:o.ring.concat(n.ring)}):(delete g[n.start],n.ring.unshift(i),g[n.start=c]=n):g[c]=p[s]={start:c,end:s,ring:[i,u]}}var f,a,c,s,d,h,g=new Array,p=new Array;for(f=a=-1,s=r[0]>=n,l[s<<1].forEach(o);++f<i-1;)c=s,s=r[f+1]>=n,l[c|s<<1].forEach(o);for(l[s<<0].forEach(o);++a<u-1;){for(f=-1,s=r[a*i+i]>=n,d=r[a*i]>=n,l[s<<1|d<<2].forEach(o);++f<i-1;)c=s,s=r[a*i+i+f+1]>=n,h=d,d=r[a*i+f+1]>=n,l[c|s<<1|d<<2|h<<3].forEach(o);l[s|d<<3].forEach(o)}for(f=-1,d=r[a*i]>=n,l[d<<2].forEach(o);++f<i-1;)h=d,d=r[a*i+f+1]>=n,l[d<<2|h<<3].forEach(o);l[d<<3].forEach(o)}function e(r){return 2*r[0]+r[1]*(i+1)*4}function o(r,n,t){r.forEach(function(r){var e,o=r[0],f=r[1],a=0|o,c=0|f,s=n[c*i+a];o>0&&o<i&&a===o&&(e=n[c*i+a-1],r[0]=o+(t-e)/(s-e)-.5),f>0&&f<u&&c===f&&(e=n[(c-1)*i+a],r[1]=f+(t-e)/(s-e)-.5)})}var i=1,u=1,g=n.thresholdSturges,p=o;return r.size=function(n){if(!arguments.length)return[i,u];var t=Math.ceil(n[0]),e=Math.ceil(n[1]);if(!(t>0&&e>0))throw new Error("invalid size");return i=t,u=e,r},r.thresholds=function(n){return arguments.length?(g="function"==typeof n?n:s(Array.isArray(n)?f.call(n):n),r):g},r.smooth=function(n){return arguments.length?(p=n?o:h,r):p===o},r};r.contours=g,Object.defineProperty(r,"__esModule",{value:!0})});